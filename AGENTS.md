# WorldMonitor Agent Guidelines

This document provides essential information for AI agents operating in the WorldMonitor codebase.

## üõ†Ô∏è Build & Verification

### Commands
- **Type Check**: `npm run typecheck` (Run this after ANY code change)
- **Build (Full)**: `npm run build:full`
- **Build (Tech)**: `npm run build:tech`
- **Dev Server**: `npm run dev`

### Testing
- Currently, there are no automated tests configured (`jest`, `vitest`, etc.).
- **Verification relies on `npm run typecheck` and successful build.**
- Ensure no console errors in browser runtime when possible.

## üìù Code Style & Conventions

### Language & Frameworks
- **Language**: TypeScript (Strict mode enabled)
- **Frontend**: Native Web Components / Vanilla JS structure (no React/Vue/Angular)
- **Bundler**: Vite
- **Maps**: Deck.gl & MapLibre GL

### Formatting & Naming
- **Indentation**: 2 spaces
- **Quotes**: Single quotes preferred
- **Imports**: Use absolute paths with `@/` alias (maps to `src/`)
  - Example: `import { t } from '@/utils'` instead of `../../utils`
- **File Names**: PascalCase for Classes/Components (`TechEventsPanel.ts`), camelCase for utilities (`sanitize.ts`).

### Safety & Security
- **XSS Prevention**: ALWAYS use `escapeHtml()` when inserting user-generated content or API data into DOM.
  ```typescript
  import { escapeHtml } from '@/utils/sanitize';
  element.innerHTML = `<span>${escapeHtml(data.title)}</span>`;
  ```
- **Secrets**: NEVER commit API keys or secrets. Use environment variables.

## üåç Internationalization (i18n)

### Translation Rules
- **All UI strings must be translated.**
- Use the `t()` helper function:
  ```typescript
  import { t } from '@/utils';
  element.textContent = t('My Label');
  ```
- **Translation Files**:
  - English: `src/i18n/en/index.ts`
  - Traditional Chinese: `src/i18n/zh-TW/index.ts`
- **Workflow**:
  1. Add the English string as the key in `src/i18n/en/index.ts`.
  2. Add the Traditional Chinese translation in `src/i18n/zh-TW/index.ts`.
  3. Use `t('Key String')` in the code.

## üöÄ Deployment & Branching

- **Main Branch**: `main` (Production)
- **Beta Branch**: `beta` (Staging)
- **Rules**:
  - **NEVER** push to `main` without explicit user request.
  - **NEVER** merge branches without permission.
  - Vercel automatically deploys on push.

## üß© Site Variants

The app has two variants controlled by `VITE_VARIANT`:
1. **Full (World/Geopolitical)**: Default. Focus on conflicts, risks, intel.
2. **Tech (Startup/AI)**: Focus on VC, startups, tech news.

**Development**:
- Run full: `npm run dev`
- Run tech: `npm run dev:tech`

## üì° Data Sources & Proxy

- **RSS Feeds**: Added in `src/config/feeds.ts`.
- **CORS Proxy**: New feeds MUST be added to `ALLOWED_DOMAINS` in `api/rss-proxy.js` to avoid 403 errors.
- **Custom Scrapers**: Located in `/api/` (e.g., `/api/fwdstart`).

## ü§ñ Model Preferences

- **Coding**: `claude-3-5-sonnet` (preferred) or `gpt-4o`.
- **Reasoning**: `o1-preview` or `o3-mini`.

---
*Generated by Antigravity Agent on 2026-02-12*
